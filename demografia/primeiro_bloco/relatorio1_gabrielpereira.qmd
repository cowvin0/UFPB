---
format: pdf
title: Relatório (escolher o nome depois)
number-sections: false
indent: true
whitespace: small
documentclass: scrreprt
lang: pt-br
bibliography: ../includes/bib.bib
csl: ../includes/ufpe-abnt.csl
subtitle: Universidade Federal da Paraíba - CCEN
author: Gabriel de Jesus Pereira
date: today
date-format: long
highlight-style: github
fontsize: 12pt
interlinespace: 1.5pt
fig-cap-location: bottom
warning: false
echo: false
include-in-header:
  - text: |
      \usepackage{pdflscape}
      \newcommand{\blandscape}{\begin{landscape}}
      \newcommand{\elandscape}{\end{landscape}}
---



# Introdução

```{python}
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns
```

O estado do Rio de Janeiro, localizado na região Sudeste do Brasil, é um dos estados mais importantes e influentes do país. De acordo com o último censo realizado, o de 2022, o estado do Rio de Janeiro como um todo

# Metodologia

## Recursos computacionais

\ \ \ As análises a seguir foram realizadas utilizando a linguagem de programação R [@rlang] com o conjunto de pacotes tidyverse [@tidy] para ciência de dados, utilizando principalmente o pacote ggplot2 [@ggplot] para visualização de dados. Além disso, os documentos do relatório foram feitos com o Quarto [@quarto], um sistema de escrita e publicação científica, e os códigos utilizados estão disponíveis no GitHub [@github].

## Obtenção dos dados

\ \ \ A obtenção dos dados demográficos foi realizada através de duas fontes. Os dados de mortalidade e natalidade foram obtidos através do TABNET, desenvolvido pelo DATASUS. O TABNET é um tabulador genérico de domínio público que permite organizar dados de forma rápida, conforme a consulta que se deseja tabular, e o DATASUS providencia informações que podem servir para analisar saúde pública e variáveis demográficas que ajudam na elaboração de programas de ações de saúde. Além disso, os dados referentes à quantidade da população do estado do Rio de Janeiro foram obtidos atráveis de estimativas do Instituto Brasileiro de Geografia e Estatística - IBGE.

\vspace{12pt}

\ \ \ A análise considerada abrange o período de 2010 a 2020, portanto, os dados de população, mortalidade e natalidade estão delimitados nesse intervalo. Os dados de mortalidade estão detalhados por município dentro do estado do Rio de Janeiro. As projeções populacionais do IBGE incluem faixas etárias e são divididas por sexo, o que permite a análise da pirâmide etária do estado do Rio de Janeiro. Além disso, os dados de natalidade estão categorizados por diferentes intervalos de nascidos vivos, proporcionando uma visão detalhada dos padrões de natalidade na região.


## Análise Exploratória de Dados

\ \ \ A análise exploratória de dados é uma etapa fundamental em qualquer estudo que utilize a estatística como principal ferramenta de análise. Ela permite identificar padrões de comportamento nos dados e descobrir relações entre as variáveis estudadas. Assim, após a coleta e organização dos dados, a primeira etapa deste estudo foi a análise exploratória de dados. Essa etapa possibilitou a análise dos comportamentos de natalidade, mortalidade e crescimento populacional. Para identificar esses diferentes comportamentos, foram elaborados gráficos e tabelas.

## Estatísticas para análise demográfica

\ \ \ As estatísticas utilizadas nesse trabalho para análise da população do estado do Rio de Janeiro descrevem a situação da população em relação a mortalidade, natalidade e o crescimento populacional. O crescimento populacional relaciona as duas últimas informações, podendo ter duas principais descrições: População Fechada ou População Aberta. No caso da população fechada, a estrutura populacional sofre alteração apenas pelos nascimentos e óbitos, portanto, não é afetada por migrações externas. Um exemplo de população fechada é a Coreia do Norte, um dos países mais fechados do mundo, tanto culturamente quanto populacionalmente. Não obstante, uma população aberta incluí as características das populações fechadas, mas é impactada também pela dinâmica migratória, como é o caso do estado do Rio de Janeiro. Dessa forma, o crescimento populacional de uma população aberta pode ser expresso por

$$
P_n - P_0 = N_t - O_t + I_t - E_t
$${#eq-popcres}
em que $P_0$ e $P_n$ denotam a população inicial em um tempo 0 e final em um tempo $t = n$, respectivamente. $N_t$ e $O_t$ representam o número de nascidos vivos e óbitos. E, como a população é aberta, ela será impactada pela dinâmica de migração. Portanto, a imigração e emigração em um tempo $t$ são representadas por $I_t$ e $E_t$, respectivamente. A diferença entre o número de nascidos vivos e óbitos
$$
N_t - O_t
$$
é chamada de crescimento natural, e a diferença entre o número de imigrantes e emigrantes
$$
I_t - E_t
$$
em um território é chamada de migração líquida.

\vspace{12pt}

A expressão da @eq-popcres pode ser dividida por uma quantidade $P_m$, que representa o número de anos-pessoas vividos na população em um intervalo de tempo $t$, obtendo a seguinte expressão

$$
\frac{P_n - P_0}{P_m} = \frac{N_t}{P_m} - \frac{O_t}{P_m} + \frac{I_t}{P_m} - \frac{E_t}{P_m}
$$
Cada termo da igualdade dividido por $P_m$ entregam diferentes estatísticas para análise da população. As estatísticas serão explicadas nas próximas sessões.

### Taxa bruta de crescimento (r)

\ \ \ A taxa bruta de crescimento é a diferença entre a população final em um tempo $t = n$ e a população inicial em um tempo $t = 0$, dividido por $P_m$. Essa estatística indica a intensidade de crescimento anual da população residente. A sua expressão é dada da seguinte forma

$$
r = \frac{P_n - P_0}{P_m}
$$

A taxa bruta de crescimento é impactada por todas as dinâmicas populacionais, número de nascidos vivos, óbitos e mudanças migratórias.

### Taxa bruta de natalidade (TBN)

A taxa bruta de natalidade expressa o número de nascidos vivos por mil habitantes, ocorridos na população geral, em determinado período. A sua definição matemática é dada por

$$
TBN = \frac{N_t}{P_m} 1000
$$

Essa taxa é influenciada pela estrutura da população, por sexo e idade e condicionada por fatores socioeconômicos de um país. Não obstante, entender essa taxa significa dimensionar a frequência de nascimentos vivos em determinada população para, por exemplo, ter um planejamento de assistência materno-infantil, planejar políticas de saúde e educação.

### Taxa bruta de mortalidade (TBM)

\ \ \ A estatística de taxa bruta de mortalidade mede a quantidade de óbitos em uma população especifíca durante um período de tempo, em relação a população total. A sua fórmula é expressa por

$$
TBM = \frac{O_t}{P_m} 1000
$$
em que $O_t$ é o número de óbitos em um tempo $t$. Além disso, a TBM é expressa em número de mortes por mil habitantes. Este indicador é importante para avaliar a saúde de uma população, a eficácia dos sistemas de saúde e para planejar políticas de saúde pública.

### Taxa de crescimento natural (r)

A taxa de crescimento natural é a diferença entre o TBN e o TBM, sendo expresso da seguinte forma:

$$
TCN = TBN - TBM
$$

Se a TCN for positiva, isso indica que a população está crescendo naturalmente; se for negativa, indica que a população está diminuindo.

### Taxa bruta de imigração (TBI)

A taxa bruta de imigração mede o número de pessoas que imigram para uma determinada região durante um tempo $t$, em relação à população total dessa área ou país. Ela é calculada como a divisão entre o número de imigrantes que chegaram à área e a população total no meio do período, expressa por mil habitantes por ano. Assim, tem-se

$$
TBI = \frac{I_t}{P_m} 1000
$$

Esse indicador é importante para avaliar o impacto da imigração sobre o crescimento populacional e para planejar políticas relacionadas a integração social, mercado de trabalho e outras áreas afetadas pela chegada de novos residentes.

### Taxa bruta de emigração

A taxa bruta de emigração é uma estatística demográfica que mede o número de pessoas que emigram, ou seja, deixam uma determinada área ou país para viver em outro lugar durante um período de tempo, em relação à população total dessa área ou país. A fórmula básica para calcular a taxa bruta de emigração é:

$$
TBE = \frac{E_t}{P_m} 1000
$$

A taxa bruta de emigração é expressa em número de emigrantes por mil habitantes por ano. Este indicador é usado para analisar a saída de pessoas de uma região e entender os impactos dessa saída na população, na economia e em outros aspectos sociais. Um exemplo de utilização da taxa bruta de emigração é o conflito entre Rússia e Ucrânia. A TBE pode ser utilizada para avaliar a perda de mão de obra que um país enfrenta durante o período de guerra devido à emigração para outros países.

### Taxa líquida de migração

\ \ \ A taxa líquida de imigração é a diferença entre a TBE e TBI, durante um período determinado de tempo. Essa taxa reflete o saldo migratório, ou seja, o impacto líquido da migração sobre o tamanho da população de uma região. Dessa forma, tem-se a seguinte expressão:

$$
TLM = TBE - TBI
$$

A TLM é expressa em número de pessoas por mil habitantes por ano. Um valor positivo indica que a imigração supera a emigração, resultando em um aumento populacional devido à migração. Um valor negativo indica que a emigração supera a imigração, resultando em uma diminuição populacional.

\vspace{12pt}

Este indicador é útil para entender as dinâmicas migratórias de uma região e para planejar políticas públicas que respondam às mudanças populacionais provocadas pela migração.

## Taxa média geométrica de crescimento anual

A Taxa média geométrica de crescimento anual é uma medida que mostra, em percentual, quanto uma população cresceu ao ano durante o período indicado. Essa estatística demográfica é influenciada pala dinâmica de natalidade, mortalidade e migrações. Assim, a sua expressão é dada por

$$
TGCA = \sqrt[n]{\frac{P_n}{P_0}} - 1
$$
em que $n$ denota o número de anos no período. Se o TGCA for negativo, é um indicativo que a população está descrescendo, caso contrário, está crescendo.

## Tempo de duplicação de uma população

No tempo de duplicação de uma população é pressuposto que a população será o dobro em um tempo final $n$. Dessa forma, $P_n/P_0 = 2$ e, fazendo o logaritmo da expressão anterior, temos $\ln(P_n/P_0) = 0.693$. Assim, tem-se a expressão final do tempo de duplicação de uma população

$$
\frac{0.693}{r}
$$
em que $r$ denota uma taxa de crescimento. Portanto, a tempo de duplicação é interpretado como quanto tempo levará para uma população atingir o dobro do tamanho inicial.

# Resultados



```{python}
mortalidade = pd.read_csv('mortalidade.csv', delimiter=';')

natalidade = pd.read_csv('natalidade.csv', delimiter=';')

cat_type = pd.api.types.CategoricalDtype(
  categories=[f"{i}-{i + 4}" for i in range(0, 89, 5)] + ["90+"],
  ordered=True
)

populacao = pd.read_excel("projecoes_pop_rj.xls")\
  .melt(
    id_vars=["Idade", "Sexo"],
    value_vars=list(range(2010, 2021)),
    var_name="Ano",
    value_name="População"
  )\
  .assign(
    Idade=lambda x: x.Idade.astype(cat_type)
  )\
  .sort_values("Idade", ascending=False)\
  .reset_index(drop=True)

dados_juntos = natalidade\
  .set_index('Ano')\
  .join(mortalidade.set_index('Ano'))\
  .join(
    populacao\
      .groupby('Ano')['População']\
      .sum()\
      .to_frame()
  )\
  .stack()\
  .to_frame()\
  .reset_index()\
  .rename(
    columns={
      'level_1': 'Tipo',
      0: 'Valores'
    }
  )
```


## Descritiva dos dados

\ \ \ A análise exploratória dos dados de mortalidade, natalidade e projeções populacionais do estado do Rio de Janeiro começou com o entendimento da estrutura dos dados disponíveis. Para isso, a distribuição dos dados foi analisada por meio de histogramas, como mostrado na @fig-parom. No primeiro gráfico à esquerda, observa-se a distribuição dos nascidos vivos no estado do Rio de Janeiro. Nota-se um crescimento no número de nascidos vivos até o ano de 2015; contudo, após 2015, esses números diminuem rapidamente, atingindo sua maior redução em 2020.

::: {#fig-parom}

```{python}
g = sns.FacetGrid(
  dados_juntos.assign(Ano=lambda x: pd.Categorical(x.Ano)),
  col='Tipo',
  sharey=False,
  sharex=False,
  legend_out=False,
  hue='Tipo',
  height=6
  )
g.map_dataframe(sns.barplot, 'Ano', 'Valores')
g.add_legend(loc='lower center', bbox_to_anchor=(1.69, -0.20), ncol=3)
g.set_ylabels('')
g.set_xlabels('')
g.set_titles('')

plt.show()
```

Gráficos de barra que mostram os nascidos vivos, óbitos e população população do estado do Rio de Janeiro entre 2011 a 2020.
:::

\ \ \ Analisando agora o histograma em cor laranja, que representa a distribuição dos óbitos, observa-se uma tendência de aumento constante no número de mortes. Embora não seja possível determinar com precisão a causa desse aumento, é importante considerar os diversos problemas sociais e de segurança pública enfrentados pelo estado do Rio de Janeiro. No entanto, ao observar o ano de 2020, destaca-se que esse período coincide com o auge da pandemia de Covid-19 no estado, o que provavelmente explica o aumento significativo no número de óbitos registrado naquele ano. Por fim, o gráfico verde, que representa a distribuição da população do estado, mostra uma tendência praticamente constante. É importante notar que, apesar da queda na natalidade e óbitos, o crescimento populacional pode estar sendo significativamente influenciado pela dinâmica migratória.

\vspace{12pt}

\ \ \ Os dois gráficos da figura @fig-py são as pirâmides etárias do estado do rio de janeiro.

::: {#fig-py layout-nrow=2}

```{python}
#| label: fig-pop2020

demo_py = populacao.pivot(
  index=["Idade", "Ano"],
  columns="Sexo",
  values="População")\
  .reset_index()\
  .sort_values("Idade", ascending=False)\
  .assign(
    Masculino=lambda x: -x.Masculino
  )

barplot = sns.barplot(
  x="Masculino",
  y="Idade",
  data=demo_py.query("Ano == 2020"),
  order=demo_py.query("Ano == 2020").Idade,
  color="#049899",
  lw=0
  )
barplot = sns.barplot(
  x="Feminino",
  y="Idade",
  data=demo_py.query("Ano == 2020"),
  order=demo_py.query("Ano == 2020").Idade,
  color="#ED9502",
  lw=0
)

plt.xlabel("")
plt.ylabel("")
plt.xticks(
  ticks=[int(i) for i in list(range(-600_000, 800_000, 200_000))],
  labels=["600", "400", "200", "0", "200", "400", "600"]
)
plt.show()
```

```{python}
#| label: fig-pop2010

barplot = sns.barplot(
  x="Masculino",
  y="Idade",
  data=demo_py.query("Ano == 2010"),
  order=demo_py.query("Ano == 2010").Idade,
  label="Masculino",
  color="#049899",
  lw=0
  )
barplot = sns.barplot(
  x="Feminino",
  y="Idade",
  data=demo_py.query("Ano == 2010"),
  order=demo_py.query("Ano == 2010").Idade,
  label="Feminino",
  color="#ED9502",
  lw=0
)

plt.xlabel("")
plt.ylabel("")
plt.xticks(
  ticks=[int(i) for i in list(range(-600_000, 800_000, 200_000))],
  labels=["600", "400", "200", "0", "200", "400", "600"]
)
plt.legend(loc='upper center', bbox_to_anchor=(0.5, -.1), ncol=2)
plt.show()
```

Gráfico de pirâmide etária que mostra a distribuição da população (em milhares) por sexo, de acordo com os grupos de idade. O gráfico na @fig-pop2020 representa a distribuição referente ao ano de 2020, enquanto o gráfico na @fig-pop2010 refere-se ao ano de 2010.
:::

```{python eval=TRUE}
pop_2011 = dados_juntos.query('(Ano == 2011) and (Tipo == "População")').Valores.tolist()[0]
pop_2020 = dados_juntos.query('(Ano == 2020) and (Tipo == "População")').Valores.tolist()[0]
incremento_tot = pop_2020 - pop_2011
obitos_2011_2020 = dados_juntos.query('Tipo == "Óbitos"').Valores.sum()
nasc_2011_2020 = dados_juntos.query('Tipo == "Natalidade"').Valores.sum()
pop_media = dados_juntos.query('Tipo == "População"').Valores.mean()
nasc_medio = dados_juntos.query('Tipo == "Natalidade"').Valores.mean()
obito_medio = dados_juntos.query('Tipo == "Óbitos"').Valores.mean()
taxa_nata = nasc_medio / pop_media * 1000
taxa_mortalidade = obito_medio / pop_media * 1000
r = taxa_nata - taxa_mortalidade
taxa_geometrica_cresc = (pop_2020 / pop_2011) ** 10 - 1

pd.DataFrame(
  {
    'População e indicadores de crescimento demográfico': [
      'População 2011', 'População 2020', 'Incremento total',
      'Óbitos entre 2011 e 2020', 'Nascimentos entre 2011 e 2020',
      'Óbitos médios entre 2011 e 2020', 'Nascimentos médios entre 2011 e 2020', 'População média entre 2011 e 2020', 'Taxa bruta de natalidade', 'Taxa bruta de mortalidade',
      'Taxa de crescimento natural', 'Taxa média geométrica de crescimento anual (%)'
    ],
    'Estrutura conciliatória': [
      pop_2011,
      pop_2020,
      incremento_tot,
      obitos_2011_2020,
      nasc_2011_2020,
      obito_medio,
      nasc_medio,
      pop_media,
      taxa_nata,
      taxa_mortalidade,
      r,
      taxa_geometrica_cresc * 100
    ]
  }
).style.hide()
```

# Conclusão
