---
format: pdf
title: |
  Comparação indicadores demográficos entre Brasil e Rio de Janeiro (censo de 2000 e 2010)
number-sections: false
indent: true
whitespace: small
documentclass: scrreprt
lang: pt-br
bibliography: ../includes/bib.bib
csl: ../includes/ufpe-abnt.csl
subtitle: Universidade Federal da Paraíba - CCEN
author: Gabriel de Jesus Pereira
date: today
date-format: long
highlight-style: github
fontsize: 12pt
interlinespace: 1.5pt
fig-cap-location: bottom
warning: false
echo: false
include-in-header:
  - text: |
      \usepackage{pdflscape}
      \newcommand{\blandscape}{\begin{landscape}}
      \newcommand{\elandscape}{\end{landscape}}
---

```{r}
library(reticulate)
```

```{python}

import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
```

# Introdução

\ \ \ Este estudo tem como objetivo realizar uma análise comparativa abrangente entre o estado do Rio de Janeiro e o Brasil, utilizando dados dos censos de 2000 e 2010. Através dessa comparação temporal, busca-se entender as mudanças e tendências demográficas que ocorreram ao longo da década, focando em indicadores chave como o Índice de Envelhecimento, a Idade Mediana, as Pirâmides Etárias, a Razão de Dependência e o Índice de Myers. Esses indicadores oferecem uma visão detalhada da estrutura etária e das transformações populacionais em ambas as regiões. Além disso, todas as análises serão realizadas separadamente para homens e mulheres, permitindo avaliar as dinâmicas demográficas de forma desagregada por sexo, o que enriquece a compreensão das particularidades de cada grupo e das implicações dessas mudanças para o planejamento socioeconômico e de políticas públicas.

# Metodologia

## Obtenção dos dados

\ \ \ Os dados demográficos utilizados neste estudo foram obtidos de duas fontes principais. As informações sobre a população por faixa etária foram extraídas do TABNET, uma ferramenta desenvolvida pelo DATASUS. O TABNET é um tabulador genérico de domínio público que facilita a organização e consulta rápida de dados conforme os critérios definidos, enquanto o DATASUS fornece informações essenciais para a análise da saúde pública e variáveis demográficas, contribuindo para a formulação de políticas e programas de saúde. Os dados populacionais detalhados por idade para o estado do Rio de Janeiro e para o Brasil foram obtidos por meio do Sidra. É importante destacar que os dados analisados correspondem aos censos de 2000 e 2010.

## Recursos computacionais

\ \ \ As análises apresentadas neste estudo foram realizadas utilizando a linguagem de programação Python [@van1995python], com o auxílio da biblioteca Pandas [@reback2020pandas] para manipulação de dados e da biblioteca Matplotlib para visualização gráfica [@Hunter:2007]. Os documentos do relatório foram elaborados com o Quarto [@quarto], um sistema de escrita e publicação científica. Todo o código-fonte utilizado nas análises está disponível no GitHub [@github].

## Razão de Sexo

\ \ \ A razão de sexo é uma medida demográfica que expressa a proporção entre o número de homens e mulheres em uma determinada população. Essa medida mede o balanço relativo dos sexos ao comparar o montante masculino com o do feminino. A fórmula geral é:

$$
RS = \frac{P^m}{P^f} \times 100
$$

\ \ \ A razão de sexo é uma ferramenta fundamental em estudos demográficos, pois permite compreender a estrutura populacional e identificar possíveis desequilíbrios que podem ter implicações sociais, econômicas e de saúde pública. Em algumas regiões, uma razão de sexo desproporcional pode indicar práticas de discriminação de gênero, preferências culturais por filhos de determinado sexo ou condições econômicas que afetam de maneira distinta homens e mulheres.

## Índice de envelhecimento da população

\ \ \ O Índice de Envelhecimento (IE) é uma medida demográfica que quantifica o grau de envelhecimento de uma população. Ele é calculado como a razão entre o número de pessoas idosas (geralmente definidas como aquelas com 65 anos ou mais) e o número de jovens (aqueles com menos de 15 anos), multiplicado por 100. A fórmula é:

$$
IE = \frac{\text{População de 65 anos ou mais}}{\text{População de 0 a 14 anos}} \times 100
$$

\ \ \ Um IE de 100 indica que há um número equivalente de idosos e jovens na população. Quando o IE é superior a 100, isso sugere uma população mais envelhecida, com mais idosos do que jovens. Por outro lado, valores abaixo de 100 indicam que a população tem uma maior proporção de jovens.

## Razão de Dependência

\ \ \ A razão de dependência é um indicador demográfico que expressa a relação entre a população considerada economicamente dependente (crianças e idosos) e a população em idade ativa, geralmente vista como economicamente produtiva. Esse indicador é fundamental para avaliar a pressão econômica sobre a população em idade de trabalho, pois revela quantas pessoas dependentes cada trabalhador, em potencial, precisa sustentar. A compreensão desse índice é essencial para o desenvolvimento de estratégias econômicas e sociais que promovam o bem-estar de todas as faixas etárias da população. A razão de dependência é dividida em três estatísticas distintas, que serão detalhadas a seguir.

### Razão de Dependência Total (RDT)

\ \ \ Reflete a soma das razões de dependência de jovens e idosos, expressando o total de pessoas dependentes (jovens e idosos) em relação à população em idade ativa.

$$
RDT = \frac{\text{População de 0 a 14 anos + População de 65 anos ou mais}}{\text{População de 15 a 64 anos}} \times 100
$$

### Razão de Dependência Jovem (RDJ)

\ \ \ Calcula a proporção de jovens (0 a 14 anos) em relação à população em idade ativa (15 a 64 anos), indicando o peso da população jovem sobre a força de trabalho.

$$
RDJ = \frac{\text{População de 0 a 14 anos}}{\text{População de 15 a 64 anos}} \times 100
$$

### Razão de Dependência Idoso (RDI)

\ \ \ Calcula a proporção de idosos (65 anos ou mais) em relação à população em idade ativa (15 a 64 anos), indicando o impacto da população idosa sobre a força de trabalho.

$$
RDI = \frac{\text{População de 65 anos ou mais}}{\text{População de 15 a 64 anos}} \times 100
$$

## Idade Mediana

\ \ \ A idade mediana é uma medida estatística que representa o ponto central da distribuição etária de uma população. Em outras palavras, é a idade que divide a população em duas metades iguais: 50% das pessoas são mais jovens que essa idade, e os outros 50% são mais velhos.

\vspace{12pt}

\ \ \ A idade mediana é um indicador valioso para compreender a estrutura etária de uma população, sendo amplamente utilizada em estudos demográficos e socioeconômicos para avaliar o estágio do processo de transição demográfica de um país ou região. Em países com uma idade mediana baixa, a população tende a ser jovem, o que pode estar associado a altas taxas de natalidade e rápido crescimento populacional. Por outro lado, em países com uma idade mediana elevada, a população tende a ser mais velha, refletindo baixas taxas de natalidade e aumento da longevidade.

## Pirâmide etária

\ \ \ A pirâmide etária é um gráfico que representa a distribuição da população de uma região ou país por faixas etárias, geralmente separadas por sexo (homens e mulheres). Ela recebe o nome de "pirâmide" devido ao formato característico observado em sociedades jovens, onde a base larga indica uma grande proporção de crianças e jovens, enquanto o topo estreito reflete uma menor proporção de idosos.

\vspace{12pt}

\ \ \ A análise de uma pirâmide etária permite compreender o crescimento populacional de uma região ou país. Uma base larga sugere uma população em crescimento, enquanto um topo mais largo indica um aumento da proporção de idosos. Alterações no formato da pirâmide podem demandar ajustes em políticas públicas nas áreas de saúde, educação, previdência social e mercado de trabalho.

## Índice de Myers

\ \ \ O Índice de Myers é utilizado para determinar a preferência por cada dígito terminal (0 a 9) nas idades que variam de 10 a 99 anos. Esse método parte da suposição de que a distribuição dos dígitos terminais é uniforme. O cálculo do Índice de Myers consiste na soma das diferenças absolutas entre a distribuição observada das idades terminadas em cada dígito (de 0 a 9) e uma distribuição esperada uniforme, onde cada dígito deveria aparecer com a mesma frequência. O valor do índice varia de 0 a 90, sendo que 0 indica uma distribuição perfeita, sem preferência por nenhum dígito, e 90 indica a concentração total em um único dígito.

# Resultados

## Análise da razão de sexo (Brasil e Rio de Janeiro)

\ \ \ A razão de sexo foi inicialmente calculada para os dados do censo de 2000. Os resultados estão apresentados na tabela abaixo. Para calcular a razão de sexo, a população foi dividida entre as situações rural e urbana, e a razão foi obtida comparando a população masculina com a feminina em cada situação. Os cálculos foram realizados tanto para o Brasil como um todo quanto para o estado do Rio de Janeiro.

```{python}
homens_urbanos_rural_2000 = pd\
  .read_csv('2000_homens_urbana_rural.csv', delimiter=';')\
  .assign(Sexo='Masculino')

mulheres_urbanos_rural_2000 = pd\
  .read_csv('2000_mulheres_urbana_rural.csv', delimiter=';')\
  .assign(Sexo='Feminino')

juntos_urbano_rural_2000 = pd.concat([homens_urbanos_rural_2000, mulheres_urbanos_rural_2000])\
  .reset_index(drop=True)\
  .assign(rj_total=lambda x: x['Unidade da Federação'].isin(["Total", "33 Rio de Janeiro"]))\
  .query('rj_total')\
  .reset_index(drop=True)\
  .drop(columns=['rj_total'])\
  .pivot_table(
    index='Unidade da Federação',
    columns='Sexo',
    values=['Urbana', 'Rural', 'Total']
  )\
  .rename(index={'Total': 'Brasil', '33 Rio de Janeiro': 'Rio de Janeiro'}, columns={'Urbana': 'Urbano'})

razao_sexo_2000 = juntos_urbano_rural_2000\
  .assign(
    Razão_de_Sexo_Rural=lambda x: x.Rural.Masculino / x.Rural.Feminino * 100,
    Razão_de_Sexo_Urbana=lambda x: x.Urbano.Masculino / x.Urbano.Feminino * 100,
    Razão_de_Sexo_Brazil=lambda x: x.Total.Masculino / x.Total.Feminino * 100
    )\
  .drop(columns=['Rural', 'Urbano', 'Total'])\
  .rename(columns={
    'Razão_de_Sexo_Brazil': 'Razão de Sexo - Total',
    'Razão_de_Sexo_Urbana': 'Razão de Sexo - Urbano',
    'Razão_de_Sexo_Rural': 'Razão de Sexo - Rural'})

juntos_urbano_rural_2000.style.hide()
```

\ \ \ Assim, com os dados de população de 2000, chegamos a seguinte razão de sexo:

```{python}
razao_sexo_2000.style.hide()
```

\ \ \ No ano de 2000, a razão de sexo tanto para o estado do Rio de Janeiro quanto para o Brasil como um todo é bastante equilibrada, com poucas diferenças entre os dois cenários. No entanto, ao analisar exclusivamente a população residente em áreas rurais, observa-se que há um número maior de homens. Um possível motivo para essa discrepância é que as mulheres tendem a sair das áreas rurais em busca de oportunidades de emprego, uma vez que no campo há menos opções de trabalho para elas.

\vspace{12pt}

Agora será observado o ano de 2010 e calculado a razão de sexo. A tabela da população com os dados do censo de 2010 pode ser vista na tabela abaixo.

```{python}
homens_urbanos_rural_2010 = pd\
  .read_csv('2010_homens_urbanos_rural.csv', delimiter=';')\
  .assign(Sexo='Masculino')

mulheres_urbanos_rural_2010 = pd\
  .read_csv('2010_mulheres_urbanas_rural.csv', delimiter=';')\
  .assign(Sexo='Feminino')

juntos_urbano_rural_2010 = pd.concat([homens_urbanos_rural_2010, mulheres_urbanos_rural_2010])\
  .reset_index(drop=True)\
  .assign(rj_total=lambda x: x['Unidade da Federação'].isin(["Total", "33 Rio de Janeiro"]))\
  .query('rj_total')\
  .reset_index(drop=True)\
  .drop(columns=['rj_total'])\
  .pivot_table(
    index='Unidade da Federação',
    columns='Sexo',
    values=['Urbana', 'Rural', 'Total']
  )\
  .rename(index={'Total': 'Brasil', '33 Rio de Janeiro': 'Rio de Janeiro'}, columns={'Urbana': 'Urbano'})

razao_sexo_2010 = juntos_urbano_rural_2010\
  .assign(
    Razão_de_Sexo_Rural=lambda x: x.Rural.Masculino / x.Rural.Feminino * 100,
    Razão_de_Sexo_Urbana=lambda x: x.Urbano.Masculino / x.Urbano.Feminino * 100,
    Razão_de_Sexo_Brazil=lambda x: x.Total.Masculino / x.Total.Feminino * 100,
    )\
  .drop(columns=['Rural', 'Urbano', 'Total'])\
  .rename(columns={
    'Razão_de_Sexo_Brazil': 'Razão de Sexo - Total',
    'Razão_de_Sexo_Urbana': 'Razão de Sexo - Urbano',
    'Razão_de_Sexo_Rural': 'Razão de Sexo - Rural'})

juntos_urbano_rural_2010.style.hide()
```

\ \ \ A razão de sexo de 2010, apresentada abaixo, revela que não houve uma mudança significativa em comparação com a de 2000. No entanto, observa-se uma leve redução na proporção de mulheres em áreas urbanas e no cenário geral. Na zona rural, também houve uma diminuição na proporção de mulheres, mas a diferença em relação ao ano de 2000 não é muito expressiva.

```{python}
razao_sexo_2010.style.hide()
```

## Análise de Dependência

\ \ \ A análise de dependência foi realizada considerando as estatísticas totais, bem como as específicas para jovens e idosos, diferenciadas por sexo. Inicialmente, apresentaremos a análise em relação ao total. As razões de dependência total, jovem e idoso foram calculadas com base nos dados dos censos de 2000 e 2010. Utilizando as fórmulas definidas na metodologia, elaborou-se a tabela abaixo, que exibe as razões de dependência por sexo, além da razão total para o Brasil como um todo.

```{python}
def calcular_rdt(df, unidade):
    pop_0_14 = df[(df['Unidade da Federação'] == unidade) & (df['Intervalo de Idade'].isin(['Menor 1 ano', '1 a 4 anos', '5 a 9 anos', '10 a 14 anos']))]['Frequência'].sum()
    pop_65_mais = df[(df['Unidade da Federação'] == unidade) & (df['Intervalo de Idade'].isin(['70 a 79 anos', '80 anos e mais']))]['Frequência'].sum()
    pop_15_64 = df[(df['Unidade da Federação'] == unidade) & (df['Intervalo de Idade'].isin(['15 a 19 anos', '20 a 29 anos', '30 a 39 anos', '40 a 49 anos', '50 a 59 anos', '60 a 69 anos']))]['Frequência'].sum()

    rdt = 100 * (pop_0_14 + pop_65_mais) / pop_15_64
    return rdt

def calcular_rdj(df, unidade):
    pop_0_14 = df[(df['Unidade da Federação'] == unidade) & (df['Intervalo de Idade'].isin(['Menor 1 ano', '1 a 4 anos', '5 a 9 anos', '10 a 14 anos']))]['Frequência'].sum()
    pop_15_64 = df[(df['Unidade da Federação'] == unidade) & (df['Intervalo de Idade'].isin(['15 a 19 anos', '20 a 29 anos', '30 a 39 anos', '40 a 49 anos', '50 a 59 anos', '60 a 69 anos']))]['Frequência'].sum()

    rdj = 100 * pop_0_14 / pop_15_64
    return rdj

def calcular_rdi(df, unidade):
    pop_65_mais = df[(df['Unidade da Federação'] == unidade) & (df['Intervalo de Idade'].isin(['70 a 79 anos', '80 anos e mais']))]['Frequência'].sum()
    pop_15_64 = df[(df['Unidade da Federação'] == unidade) & (df['Intervalo de Idade'].isin(['15 a 19 anos', '20 a 29 anos', '30 a 39 anos', '40 a 49 anos', '50 a 59 anos', '60 a 69 anos']))]['Frequência'].sum()

    rdi = 100 * pop_65_mais / pop_15_64
    return rdi
```

```{python}
mulher_etario_2010 = pd.read_csv('2010_faixa_etaria_mulher.csv', delimiter=';')\
  .set_index('Unidade da Federação')\
  .rename(index={'Total': 'Brasil', '33 Rio de Janeiro': 'Rio de Janeiro'})\
  .stack()\
  .reset_index()\
  .query('level_1 != "Total"')\
  .rename(columns={'level_1': 'Intervalo de Idade', 0: 'Frequência'})\
  .assign(
    Acumulado=lambda x: x.groupby('Unidade da Federação').Frequência.cumsum()
  )

categorias = mulher_etario_2010['Intervalo de Idade'].unique()

homem_etario_2010 = pd.read_csv('2010_faixa_etaria_homem.csv', delimiter=';')\
  .set_index('Unidade da Federação')\
  .rename(index={'Total': 'Brasil', '33 Rio de Janeiro': 'Rio de Janeiro'})\
  .stack()\
  .reset_index()\
  .query('level_1 != "Total"')\
  .rename(columns={'level_1': 'Intervalo de Idade', 0: 'Frequência'})\
  .assign(
    Acumulado=lambda x: x.groupby('Unidade da Federação').Frequência.cumsum()
  )
homem_etario_2010['Intervalo de Idade'] = pd.Categorical(homem_etario_2010['Intervalo de Idade'], categories=categorias)
mulher_etario_2010['Intervalo de Idade'] = pd.Categorical(mulher_etario_2010['Intervalo de Idade'], categories=categorias)
```


```{python}
mulher_etario_2000 = pd.read_csv('2000_faixa_etaria_mulher.csv', delimiter=';')\
  .set_index('Unidade da Federação')\
  .rename(index={'Total': 'Brasil'})\
  .stack()\
  .reset_index()\
  .query('level_1 != "Total"')\
  .rename(columns={'level_1': 'Intervalo de Idade', 0: 'Frequência'})\
  .assign(
    Acumulado=lambda x: x.groupby('Unidade da Federação').Frequência.cumsum()
  )

categorias = mulher_etario_2000['Intervalo de Idade'].unique()

homem_etario_2000 = pd.read_csv('2000_faixa_etaria_homem.csv', delimiter=';')\
  .set_index('Unidade da Federação')\
  .rename(index={'Total': 'Brasil'})\
  .stack()\
  .reset_index()\
  .query('level_1 != "Total"')\
  .rename(columns={'level_1': 'Intervalo de Idade', 0: 'Frequência'})\
  .assign(
    Acumulado=lambda x: x.groupby('Unidade da Federação').Frequência.cumsum()
  )
homem_etario_2000['Intervalo de Idade'] = pd.Categorical(homem_etario_2000['Intervalo de Idade'], categories=categorias)
mulher_etario_2000['Intervalo de Idade'] = pd.Categorical(mulher_etario_2000['Intervalo de Idade'], categories=categorias)

dep_total_2000 = pd.DataFrame({
  'Ano': [2000] * 4,
  'Unidade da Federação': ['Rio de Janeiro', 'Brasil'] * 2,
  'Sexo': ['Feminino', 'Feminino', 'Masculino', 'Masculino'],
  'RDT': [calcular_rdt(mulher_etario_2000, 'Rio de Janeiro'),
          calcular_rdt(mulher_etario_2000, 'Brasil'),
          calcular_rdt(homem_etario_2000, 'Rio de Janeiro'),
          calcular_rdt(homem_etario_2000, 'Brasil')],
  'RDJ': [calcular_rdj(mulher_etario_2000, 'Rio de Janeiro'),
          calcular_rdj(mulher_etario_2000, 'Brasil'),
          calcular_rdj(homem_etario_2000, 'Rio de Janeiro'),
          calcular_rdj(homem_etario_2000, 'Brasil')],
  'RDI': [calcular_rdi(mulher_etario_2000, 'Rio de Janeiro'),
          calcular_rdi(mulher_etario_2000, 'Brasil'),
          calcular_rdi(homem_etario_2000, 'Rio de Janeiro'),
          calcular_rdi(homem_etario_2000, 'Brasil')],
          })

dep_total_2010 = pd.DataFrame({
  'Ano': [2010] * 4,
  'Unidade da Federação': ['Rio de Janeiro', 'Brasil'] * 2,
  'Sexo': ['Feminino', 'Feminino', 'Masculino', 'Masculino'],
  'RDT': [calcular_rdt(mulher_etario_2010, 'Rio de Janeiro'),
          calcular_rdt(mulher_etario_2010, 'Brasil'),
          calcular_rdt(homem_etario_2010, 'Rio de Janeiro'),
          calcular_rdt(homem_etario_2010, 'Brasil')],
  'RDJ': [calcular_rdj(mulher_etario_2010, 'Rio de Janeiro'),
          calcular_rdj(mulher_etario_2010, 'Brasil'),
          calcular_rdj(homem_etario_2010, 'Rio de Janeiro'),
          calcular_rdj(homem_etario_2010, 'Brasil')],
  'RDI': [calcular_rdi(mulher_etario_2010, 'Rio de Janeiro'),
          calcular_rdi(mulher_etario_2010, 'Brasil'),
          calcular_rdi(homem_etario_2010, 'Rio de Janeiro'),
          calcular_rdi(homem_etario_2010, 'Brasil')],
          })

pd.concat([dep_total_2010, dep_total_2000], axis=0).style.hide()
```

\ \ \ A razão de dependência de jovens (RDJ) era significativamente maior no censo de 2000, tanto para o sexo masculino quanto para o feminino. No Brasil, em 2000, havia 46 jovens dependentes para cada 100 pessoas em idade ativa, no caso dos homens. Esse valor caiu para 35,32 no censo de 2010. A única situação que apresentou um aumento na dependência foi a dos idosos em 2010. Para as mulheres, a redução na dependência total, especialmente entre os jovens, foi ainda mais acentuada, refletindo uma diminuição na dependência das mulheres em relação à população economicamente ativa.

## Análise do índice de envelhecimento por sexo

\ \ \ O Índice de Envelhecimento foi calculado separadamente para os sexos feminino e masculino, tanto para o estado do Rio de Janeiro quanto para o Brasil como um todo. Os valores calculados estão apresentados abaixo.

```{python}
def calcular_ie(df, unidade):
    # Somando as frequências da população com 60 anos ou mais
    pop_60_mais = df[(df['Unidade da Federação'] == unidade) &
                     (df['Intervalo de Idade'].isin(['60 a 69 anos', '70 a 79 anos', '80 anos e mais']))]['Frequência'].sum()

    # Somando as frequências da população de 0 a 14 anos
    pop_0_14 = df[(df['Unidade da Federação'] == unidade) &
                  (df['Intervalo de Idade'].isin(['Menor 1 ano', '1 a 4 anos', '5 a 9 anos', '10 a 14 anos']))]['Frequência'].sum()

    # Calculando o Índice de Envelhecimento
    ie = (pop_60_mais / pop_0_14) * 100
    return ie

velhice_total_2000 = pd.DataFrame({
  'Ano': [2000] * 4,
  'Unidade da Federação': ['Rio de Janeiro', 'Brasil'] * 2,
  'Sexo': ['Feminino', 'Feminino', 'Masculino', 'Masculino'],
  'Índice de Envelhecimento': [calcular_ie(mulher_etario_2000, 'Rio de Janeiro'),
          calcular_ie(mulher_etario_2000, 'Brasil'),
          calcular_ie(homem_etario_2000, 'Rio de Janeiro'),
          calcular_ie(homem_etario_2000, 'Brasil')],
          })

velhice_total_2010 = pd.DataFrame({
  'Ano': [2010] * 4,
  'Unidade da Federação': ['Rio de Janeiro', 'Brasil'] * 2,
  'Sexo': ['Feminino', 'Feminino', 'Masculino', 'Masculino'],
  'Índice de Envelhecimento': [calcular_ie(mulher_etario_2010, 'Rio de Janeiro'),
          calcular_ie(mulher_etario_2010, 'Brasil'),
          calcular_ie(homem_etario_2010, 'Rio de Janeiro'),
          calcular_ie(homem_etario_2010, 'Brasil')],
          })

pd.concat([velhice_total_2010, velhice_total_2000], axis=0).style.hide()
```

\vspace{12pt}

\ \ \ Entre 2000 e 2010, observa-se um aumento significativo no Índice de Envelhecimento em todas as categorias (por sexo e por unidade da federação). Esse aumento reflete o contínuo processo de envelhecimento populacional, tanto no Rio de Janeiro quanto no Brasil como um todo.

\vspace{12pt}

\ \ \ Em 2000, o Índice de Envelhecimento (IE) para o sexo feminino no Rio de Janeiro (50,59) era consideravelmente maior do que o do Brasil (32,32), indicando que o estado já apresentava uma população feminina mais envelhecida em comparação com a média nacional. Essa diferença aumentou ainda mais até 2010, com o Rio de Janeiro atingindo um IE de 73,37, enquanto o Brasil alcançou 50,67. Isso demonstra que a população feminina do Rio de Janeiro envelheceu a um ritmo mais rápido do que a média nacional.

\vspace{12pt}

\ \ \ O IE masculino no Rio de Janeiro (34,78) também era superior ao do Brasil (25,62), embora a diferença seja menor em comparação com o sexo feminino. Em 2010, essa diferença persistiu, com o Rio de Janeiro alcançando um IE masculino de 49,90, em comparação com 39,18 no Brasil. Assim como no caso das mulheres, a população masculina do Rio de Janeiro também envelheceu mais rapidamente do que a média nacional.

## Idade Mediana

\ \ \ Para o cálculo da idade mediana, foi considerada a frequência acumulada da população. Conforme mostrado na tabela abaixo, a população total masculina do Rio de Janeiro no censo de 2000 era de 6.900.335. Dividindo esse total por 2, obtemos que a mediana da população é 3.450.167,5, o que indica que a mediana está no intervalo de 20 a 29 anos. Assim, o cálculo da idade mediana para os homens com os dados do censo de 2000 é:

$$
M_d = 20 + \left(\frac{3.450.167,5 - 2.493.359}{1.208.174}\right) \times 9
$$

$$
M_d = 20,7919
$$

\ \ \ Portanto, a idade mediana para os homens no estado do Rio de Janeiro em 2000 é de 20,7919 anos. Considerando o Brasil como um todo no ano de 2000, a população masculina total era de 83.576.015. Dividindo por 2, a mediana da população é 41.788.007,5, o que também coloca a mediana no intervalo de 20 a 29 anos, assim como no Rio de Janeiro. Calculando a mediana para a população masculina de 2000, temos:

$$
M_d = 20 + \left(\frac{41.788.007,5 -  34.526.048}{14.862.546}\right)
$$

$$
M_d = 20,4886
$$

\ \ \ Portanto, a idade mediana da população masculina do estado do Rio de Janeiro é bastante semelhante à da população masculina geral no censo de 2000.

```{python}
homem_etario_2000.style.hide()
```

\ \ \ De maneira semelhante, para o Brasil, a idade mediana das mulheres com os dados do censo de 2000 é:

\vspace{12pt}

\ \ \ Na tabela, vemos que o total de mulheres no estado do Rio de Janeiro em 2000 era de 7.490.947. Dividindo esse total por 2, obtemos 3.745.473,5, o que indica que a idade mediana está no intervalo de 30 a 39 anos. Assim, o cálculo da idade mediana para as mulheres no estado do Rio de Janeiro é:

$$
M_d = 30 + \left(\frac{3.745.473,5 - 3.700.536}{1.257.964}\right) = 30.0357
$$

Seguindo de forma semelhante para o Brasil, temos que a idade mediana do Brasil para as mulheres com os dados de censo de 2000 é:

$$
M_d = 20 + \left(\frac{43.111.577,5 - 33.679.889}{8.920.685}\right) = 21,0572
$$

```{python}
mulher_etario_2000.style.hide()
```

\ \ \ Para o ano de 2010, o cálculo da idade mediana para homens e mulheres pode ser feito da mesma forma. Portanto, com as tabelas correspondentes para homens e mulheres, temos os seguintes resultados:

```{python}
homem_etario_2010.style.hide()
```

```{python}
mulher_etario_2010.style.hide()
```

\ \ \ A partir das tabelas, a idade mediana para os homens no estado do Rio de Janeiro em 2010 é de 30,1195 anos, enquanto para o Brasil é de 20,8646 anos. Para as mulheres no Rio de Janeiro, a idade mediana em 2010 é de 30,4032 anos, comparada a 30,027 anos para o Brasil. A população masculina do Rio de Janeiro apresentou um aumento na idade mediana, embora não tenha ocorrido uma mudança significativa em relação à média nacional. Por outro lado, para as mulheres, houve um aumento mais claro na idade mediana no Brasil.

## Pirâmide etária

\ \ \ A construção da pirâmide etária foi realizada tanto para o estado do Rio de Janeiro quanto para o Brasil, considerando as populações masculina e feminina. O gráfico abaixo mostra a pirâmide etária do estado do Rio de Janeiro. Em 2010, observa-se um aumento na parte superior da pirâmide em relação ao ano de 2000, indicando um envelhecimento da estrutura populacional, especialmente entre as mulheres, destacadas pela cor laranja. A comparação entre os gráficos de 2000 e 2010 revela poucas diferenças para o estado do Rio de Janeiro, sugerindo que a dinâmica populacional do estado seguiu um padrão muito semelhante ao observado no Brasil como um todo durante esse período.

```{python}
piram_muie_2000 = mulher_etario_2000\
  .rename(columns={'Frequência': 'Feminino'})\
  .drop(columns=['Acumulado'])\
  .query('`Unidade da Federação` == "Rio de Janeiro"')

piram_homi_2000 = homem_etario_2000\
  .rename(columns={'Frequência': 'Masculino'})\
  .drop(columns=['Acumulado'])\
  .query('`Unidade da Federação` == "Rio de Janeiro"')

piram_2000 = pd.concat([piram_muie_2000, piram_homi_2000.drop(columns=['Intervalo de Idade'])], axis=1)\
  .rename(columns={'Intervalo de Idade': 'Idade', 'Unidade da Federação': 'UF'})\
  .drop(columns=['UF'])\
  .sort_values('Idade', ascending=False)
```

```{python}
piram_muie_2010 = mulher_etario_2010\
  .rename(columns={'Frequência': 'Feminino'})\
  .drop(columns=['Acumulado'])\
  .query('`Unidade da Federação` == "Rio de Janeiro"')

piram_homi_2010 = homem_etario_2010\
  .rename(columns={'Frequência': 'Masculino'})\
  .drop(columns=['Acumulado'])\
  .query('`Unidade da Federação` == "Rio de Janeiro"')

piram_2010 = pd.concat([piram_muie_2010, piram_homi_2010.drop(columns=['Intervalo de Idade'])], axis=1)\
  .rename(columns={'Intervalo de Idade': 'Idade', 'Unidade da Federação': 'UF'})\
  .drop(columns=['UF'])\
  .sort_values('Idade', ascending=False)
```

```{python}
piram_muie_2000_brasil = mulher_etario_2000\
  .rename(columns={'Frequência': 'Feminino'})\
  .drop(columns=['Acumulado'])\
  .query('`Unidade da Federação` == "Brasil"')

piram_homi_2000_brasil = homem_etario_2000\
  .rename(columns={'Frequência': 'Masculino'})\
  .drop(columns=['Acumulado'])\
  .query('`Unidade da Federação` == "Brasil"')

piram_2000_brasil = pd.concat([piram_muie_2000, piram_homi_2000.drop(columns=['Intervalo de Idade'])], axis=1)\
  .rename(columns={'Intervalo de Idade': 'Idade', 'Unidade da Federação': 'UF'})\
  .drop(columns=['UF'])\
  .sort_values('Idade', ascending=False)
```

```{python}
piram_muie_2010_brasil = mulher_etario_2010\
  .rename(columns={'Frequência': 'Feminino'})\
  .drop(columns=['Acumulado'])\
  .query('`Unidade da Federação` == "Brasil"')

piram_homi_2010_brasil = homem_etario_2010\
  .rename(columns={'Frequência': 'Masculino'})\
  .drop(columns=['Acumulado'])\
  .query('`Unidade da Federação` == "Brasil"')

piram_2010_brasil = pd.concat([piram_muie_2010, piram_homi_2010.drop(columns=['Intervalo de Idade'])], axis=1)\
  .rename(columns={'Intervalo de Idade': 'Idade', 'Unidade da Federação': 'UF'})\
  .drop(columns=['UF'])\
  .sort_values('Idade', ascending=False)
```

::: {#fig-py1 layout-ncol=2}

```{python}
#| label: fig-pir2000

barplot = sns.barplot(
  data=piram_2000.assign(Masculino=lambda x: -x.Masculino),
  x="Masculino",
  y="Idade",
  order=piram_2000['Idade'],
  color="#049899",
  lw=0
  )

barplot = sns.barplot(
  x="Feminino",
  y="Idade",
  data=piram_2000.sort_values('Idade'),
  order=piram_2000.Idade.sort_values(ascending=False).cat.categories,
  color="#ED9502",
  lw=0
)
plt.xlabel('População')
plt.show()
```


```{python}
#| label: fig-pir2010

barplot = sns.barplot(
  data=piram_2010.assign(Masculino=lambda x: -x.Masculino),
  x="Masculino",
  y="Idade",
  order=piram_2010['Idade'],
  color="#049899",
  lw=0
  )

barplot = sns.barplot(
  x="Feminino",
  y="Idade",
  data=piram_2010.sort_values('Idade'),
  order=piram_2010.Idade.sort_values(ascending=False).cat.categories,
  color="#ED9502",
  lw=0
)
plt.xlabel('População')
plt.show()
```

Gráfico de pirâmide da população no estado do Rio de Janeiro. O gráfico na figura à esquerda é a pirâmide etária do estado do Rio de Janeiro em 2000. O da direita é no ano de 2010.
:::

::: {#fig-py2 layout-ncol=2}

```{python}
#| label: fig-pir2000_brasil

barplot = sns.barplot(
  data=piram_2000_brasil.assign(Masculino=lambda x: -x.Masculino),
  x="Masculino",
  y="Idade",
  order=piram_2000_brasil['Idade'],
  color="#049899",
  lw=0
  )

barplot = sns.barplot(
  x="Feminino",
  y="Idade",
  data=piram_2000_brasil.sort_values('Idade'),
  order=piram_2000_brasil.Idade.sort_values(ascending=False).cat.categories,
  color="#ED9502",
  lw=0
)
plt.xlabel('População')
plt.show()
```


```{python}
#| label: fig-pir2010_brasil

barplot = sns.barplot(
  data=piram_2010_brasil.assign(Masculino=lambda x: -x.Masculino),
  x="Masculino",
  y="Idade",
  order=piram_2010_brasil['Idade'],
  color="#049899",
  lw=0
  )

barplot = sns.barplot(
  x="Feminino",
  y="Idade",
  data=piram_2010_brasil.sort_values('Idade'),
  order=piram_2010_brasil.Idade.sort_values(ascending=False).cat.categories,
  color="#ED9502",
  lw=0
)
plt.xlabel('População')
plt.show()
```

Gráfico de pirâmide da população no Brasil. O gráfico na figura à esquerda é a pirâmide etária no Brasil em 2000. O da direita é no ano de 2010.
:::

\newpage

## Índice de Myers

\ \ \ O Índice de Myers foi calculado para os sexos feminino e masculino, considerando mulheres e homens no ano de 2010. A tabela abaixo mostra as estatísticas obtidas para o estado do Rio de Janeiro e para o Brasil.

\vspace{12pt}

\ \ \ Os valores do Índice de Myers para o Brasil são relativamente baixos, com 2,18 para homens e 1,75 para mulheres. Isso sugere que, de maneira geral, não há uma forte tendência de arredondamento das idades ou preferências por certos dígitos, indicando que os dados etários são de boa qualidade. No entanto, os homens apresentam um valor ligeiramente mais alto do que as mulheres, sugerindo uma leve tendência de arredondamento maior entre eles.

\vspace{12pt}

\ \ \ No caso do Rio de Janeiro, os valores são um pouco mais elevados, especialmente para os homens (3,03), indicando uma maior tendência de arredondamento das idades nessa população. Embora ainda moderado, esse valor sugere uma leve concentração de idades em torno de dígitos preferenciais. As mulheres no Rio de Janeiro apresentam um índice menor (2,25), sugerindo dados ligeiramente mais confiáveis em comparação aos homens.

```{r}
library(popstudy)
library(readxl)
library(tidyverse)
library(tidyr)

df_idadepontual <- read_excel("tabela_idadepontual_2010.xlsx") |> mutate(
     Idade = rep(0:99, 2)
   )

myers_homem_brasil <- df_idadepontual |>
  filter(`Brasil e Unidade da Federação` == "Brasil") |>
  Myers(Idade, Homens)
myers_homem_rj <- df_idadepontual |>
  filter(`Brasil e Unidade da Federação` == "Rio de Janeiro") |>
  Myers(Idade, Homens)

myers_mulher_brasil <- df_idadepontual |>
  filter(`Brasil e Unidade da Federação` == "Brasil") |>
  Myers(Idade, Mulheres)
myers_mulher_rj <- df_idadepontual |>
  filter(`Brasil e Unidade da Federação` == "Rio de Janeiro") |>
  Myers(Idade, Mulheres)

tibble(
  `Brasil e Rio de Janeiro` = c("Brasil", "Rio de Janeiro"),
  Homens = c(myers_homem_brasil$MI, myers_homem_rj$MI),
  Mulheres = c(myers_mulher_brasil$MI, myers_mulher_rj$MI)
) |>
  knitr::kable()
```

# Conclusão

\ \ \ A partir das comparações entre o estado do Rio de Janeiro e o Brasil, observou-se que o Rio de Janeiro segue um padrão muito similar ao do país em todos os indicadores utilizados. No que diz respeito às pirâmides etárias, as análises revelaram que, entre 2000 e 2010, as diferenças entre as duas regiões são praticamente inexistentes para ambos os sexos. O mesmo padrão foi observado em relação à idade mediana, com um aumento no envelhecimento da população em 2010, especialmente entre as mulheres. No entanto, o envelhecimento masculino foi evidente apenas no Rio de Janeiro, enquanto, no Brasil, esse índice permaneceu estável.

\vspace{12pt}

\ \ \ No que tange ao Índice de Envelhecimento, o aumento foi mais expressivo entre as mulheres, especialmente no Rio de Janeiro. Já para a Razão de Dependência, observou-se uma queda mais acentuada entre as mulheres, refletindo uma redução na dependência feminina em relação à população economicamente ativa. A Razão de Sexo indicou uma diminuição da proporção de mulheres nas áreas rurais, provavelmente em busca de melhores oportunidades nas zonas urbanas. Por fim, o Índice de Myers sugeriu uma tendência mais acentuada de arredondamento de idades no estado do Rio de Janeiro.
