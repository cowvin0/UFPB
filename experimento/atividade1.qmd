---
title: Atividade 1 - Planejamento de Experimento
author: Gabriel de Jesus Pereira
date: '`r Sys.Date()`'
execute:
  refresh: true
  warning: false
  error: false
  eval: true
  echo: true
revealjs-plugins:
  - attribution 
  - roughnotation
  - pointer
format: 
  revealjs:
    theme: [default, style.scss]
    width: 1980
    height: 1080
    embed-resources: true
    transition: slide
    background-transition: fade
    scrollable: true
    preview-links: auto
editor:
  markdown:
    wrap: 72
lang: pt-b
---

```{r echo=FALSE}
library(tidyverse)
```
# Exercício 3.7

The tensile strength of Portland cement is being studied.
Four different mixing techniques can be used economically
A completely randomized experiment was conducted and the following
data were collected: 

```{r echo=FALSE}
data <- tibble(
  `Mixing Technique` = 1:4,
  "1" = c(3129, 3200, 2800, 2600),
  "2" = c(3000, 3300, 2900, 2700),
  "3" = c(2865, 2975, 2985, 2600),
  "4" = c(2890, 3150, 3050, 2765)
)
```

| Mixing Technique |  |  Tensile Strength $(lb/in^2)$ |  |  |
|:---:|:---:|:---:|:---:|:---:|
| 1 | 3129 | 3000 | 2865 | 2890 |
| 2 | 3200 | 3300 | 2975 | 3150 |
| 3 | 2800 | 2900 | 2985 | 3050 |
| 4 | 2600 | 2700 | 2600 | 2765 |

O enunciado da questão nos diz que a resistência à tração
do cimento de Portland está sendo estudada. Diz também
que quatro diferentes técnicas de misturas podem ser
utilizadas de forma econômica. Após isso, nos dá dados das
quatro diferentes misturas da resistência à tração do
cimento.

# Item *a)*

**(a)** Test the mixing techniques affect the
strength of the cement. Use $\alpha = 0.05$.

O item **(a)** pede para testar o efeito das técnicas de
mistura na resistência à tração do cimento, com
um nível de significância de 5%.

## Código para item *a)*

```{r}
Quadrados <- function(dados) {
  dados <- dados[-1]
  dimen <- dim(dados)
  total <- sum(dados)  
  quoc <- total^2 / prod(dimen)
  SSt <- sum(dados ^ 2) - quoc
  SStret <- sum(rowSums(dados)^2) / dimen[2] - quoc
  SSe <- SSt - SStret
  gl <- c(dimen[1] - 1, prod(dimen) - dimen[1], prod(dimen) - 1)
  MSe = c(SStret / gl[1], SSe / gl[2])
  Fe = MSe[1] / MSe[2]
  c(
    SSt = SSt, 
    SStret = SStret, 
    SSe = SSe,
    Gl = list(gl),
    MSe = list(MSe),
    Fe = Fe
    )
}
```

## Continuação *a)*

O problema se trata de um experimento de fator único com
$a = 4$ (quantidade de misturas diferentes) e $n = 4$
(réplicas de resistência à tração do cimento). Como se
trata de diferentes níveis de fator único que queremos
comparar, devemos utilizar Análise de Variância.

Calculando o total e a média para cada grupo:

| Mixing Technique |      |  Tensile Strength $(lb/in^2)$ |      |      | $y_i$ | $\hat y_i$ |
|:----------------:|:----:|:-----------------------------:|:----:|:----:|:-----:|:----------:|
|         1        | 3129 |              3000             | 2865 | 2890 | 11884 |    2671    |
|         2        | 3200 |              3300             | 2975 | 3150 | 12625 |   3156.25  |
|         3        | 2800 |              2900             | 2985 | 3050 | 11735 |   2933.75  |
|         4        | 2600 |              2700             | 2600 | 2765 | 10665 |   2666.25  |


Agora construindo a tabela da ANOVA:

|      Variação      | Soma dos Quadrados | Graus de Liberdade |         Quadrado Médio         | $F_0$ | $p-valor$ |
|:------------------:|:------------------:|:------------------:|:------------------------------:|:-----:|:---------:|
| $SS_{Tratamentos}$ |      489740.2      |          3         | $MS_{Tratamentos} = 163246.73$ | 12.72 |   4.88-4  |
|       $SS_E$       |      153908.2      |         12         |        $MS_E = 12825.69$       |       |           |
|       $SS_T$       |      643648.4      |         15         |                                |       |           |

Dessa forma, vemos que $F_0 \left( 12.728 \right) > F_{0.05, 3, 12} \left(3.49 \right)$.
Assim, rejeitamos $H_0$ e concluímos que as diferentes
técnicas de misturas afetam a resistência à tração do cimento.

# Item *b)*

**(b)** Construct a graphical display as described
in Section 3.5.3 to compare the mean tensile strengths
for the four mixing techniques. What are your conclusions?

## Código para item *b)*

# Item *c)*

**(c)** Use Fisher LSD method with $\alpha = 0.05$ to make
comparisons between pairs of means.

$LSD = t_{0.25, 12} \sqrt{\frac{2MS_E}{4}} = 2.179 \sqrt{\frac{2 x 12825.667}{4}} = 174.4947$

## Código para item *c)*

```{r}
LSD <- sqrt(2 * Quadrados(data)$MSe[2] / nrow(data)) 

diffe <- data |>
  pivot_longer(- `Mixing Technique`) |>
  select(- name) |>
  group_by(`Mixing Technique`) |>
  summarise(Média = mean(value)) |>
  (\(x) {
    n = nrow(x)
    sapply(1:(n - 1), FUN = \(i) {
      sapply((i + 1):n, FUN = \(j) {
        x$Média[i] - x$Média[j]
        })
      })
    })()
```

## Continuação *c)* 

```{r}

```

# Item *d)*

**(d)** Construct a normal probability plot of the residuals.
What conclusions would you draw about the validity of
the normality assumption?

# Item *e)*

**(e)** Plot the residuals versus the predicted tensile
strength. Comment on the plot.

# Item *f)*

**(f)** Prepare a scatter plot of the results to aid
the interpretation of the results of this experiment.
