---
title: Molusco Abalone
author: Gabriel de Jesus Pereira
date: '`r Sys.Date()`'
execute:
  refresh: true
  warning: false
  error: false
  eval: true
  echo: true
revealjs-plugins:
  - attribution 
  - roughnotation
  - pointer
format: 
  revealjs:
    theme: [default, style.scss]
    transition: slide
    background-transition: fade
    footer: "Gabriel de Jesus Pereira"
    scrollable: true
    preview-links: auto
editor:
  markdown:
    wrap: 72
lang: pt-b
---

```{r echo=FALSE}
set.seed(42)
library(dplyr)
library(GGally)
library(visdat)
library(tidyr)
library(viridis)
library(hrbrthemes)
library(tibble)
library(ggridges)
library(factoextra)
library(ggplot2)
library(corrplot)
library(ggfortify)
```


# Introdução

## O que são os Abalones

:::: {.columns}

::: {.column width="50%"}
- É um molusco gastrópode, podendo ser pequeno ou muito grande

- Servem como alimento e joias para os seres humanos, sendo a China o principal consumidor
:::

::: {.column width="50%"}
![](https://www.e-fish.com/cdn/shop/files/1lbsabalone2.jpg?v=1696278727)
:::

::::

## Sobre o banco de dados

- É um banco de dados da área de biologia que contém medidas físicas de um Abalone;

- O banco de dados contém 4177 observações;

- 8 colunas, sendo uma delas nominal e o restante numérica;

- Foi criado por Warwick Nash, Tracy Sellers, Simon Talbot, Andrew Cawthorn, Wes Ford.

## As variáveis do banco de dados {auto-animate="true"}

- Sexo do Abalone: variável nominal indicando se o Abalone é macho, fêmea ou filhote.

- Length: Medição do maior comprimento da concha

- Diameter: perpendicular ao comprimento

- Height: com carne na casca

## As variáveis do banco de dados {auto-animate="true"}

- Whole weight: abalone inteiro

- Shucked weight: peso da carne

- Viscera weight: peso das vísceras (após sangria)

- Shell weight: após ser seco

# Objetivo

# Leitura dos dados

```{r}
data <- readr::read_csv("abalone.csv") |>
  mutate(Sex = case_when(
                    Sex == "F" ~ "Fêmea",
                    Sex == "M" ~ "Macho",
                    TRUE ~ "Filhote")
  ) |>
  select(- Rings)
```

# Análise Exploratória

## Valores ausentes

```{r echo=FALSE}
data |> 
  vis_dat()
```

## Frequência de cada sexo

::: {.panel-tabset}

### Código

```{r}
Frequência <- data |> 
  ggplot(aes(x = forcats::fct_infreq(Sex))) +
  geom_bar(
        aes(y = after_stat(count) / sum(after_stat(count)), fill = Sex),
        show.legend = FALSE,
  ) +
  theme_bw() +
  theme(axis.title.x = element_blank()) +
  scale_fill_manual(
    values = viridis::mako(5)[3:5]
    ) +
  labs(y = NULL, x = NULL) 
```

### Frequência

```{r echo=FALSE}
Frequência
```

:::


## Distribuições

::: {.panel-tabset}

### Código

```{r}
Distribuição <- data |>
  pivot_longer(
    !Sex,
    names_to = "variable",
    values_to = "values"
  ) |>
  ggplot(
    aes(
      x = values, 
      fill = Sex
      )
    ) +
  geom_violin(aes(y = variable)) +
  labs(x = "", y = "") +
  facet_wrap(vars(variable), scales = "free") +
  scale_fill_manual(
    values = viridis::mako(5)[3:5], 
    name = "Sexo"
    ) +
  theme_bw() +
  theme(axis.text.y = element_blank())
```

### Distribuição

```{r echo=FALSE}
Distribuição
```

:::

## Relações

::: {.panel-tabset}

### Código

```{r output=FALSE}
Relação <- data |>
  ggpairs(
    columns = 2:8,
    upper = list(
      continuous = wrap("points", alpha = 0.4)
    ),
    lower = list(
      continuous = wrap("points", alpha = 0.4)
    )
  ) +
  theme_bw()
```

### Relação

```{r echo=FALSE}
Relação
```

:::

## Correlação

::: {.panel-tabset}

### Código

```{r output=FALSE}
data <- data |>
  (\(x) {
     scaled <- x |>
       select_if(is.numeric) |>
       scale() |>
       as_tibble()

     x |>
       select_if(is.character) |>
       cbind(scaled)
  })()

data |>
  select_if(is.numeric) |>
  cor() |>
  corrplot(
      method="circle",
      col = mako(200),
      diag = FALSE,
      addgrid.col = "#00000040",
      tl.pos = "l",
      tl.cex = 0.6,
      tl.col = "black",
      tl.offset = 0.25,
      cl.length = 9,
      cl.cex = 0.6,
      cl.ratio = 0.25,
      family = "mono"
  )
```

### Correlação

```{r echo=FALSE}
data |>
  select_if(is.numeric) |>
  cor() |>
  corrplot(
      method="circle",
      col = mako(200),
      diag = FALSE,
      addgrid.col = "#00000040",
      tl.pos = "l",
      tl.cex = 0.6,
      tl.col = "black",
      tl.offset = 0.25,
      cl.length = 9,
      cl.cex = 0.6,
      cl.ratio = 0.25,
      family = "mono"
  )
```

:::

# Componentes Principais

```{r echo=FALSE}
comp.p <- prcomp(
  data |> select_if(is.numeric),
  scale. = TRUE,
  center = TRUE, tol=0
  )
```

##

```{r}
fviz_eig(comp.p, addlabels = TRUE, barfill="#002951")
```

##

```{r}
fviz_pca_var(comp.p, col.var = "#002951",repel=TRUE)
```

##

```{r}
fviz_cos2(comp.p, choice = "var", axes = 1:2, fill="#002951")
```

##

```{r}
fviz_pca_var(comp.p, col.var = "#002951",repel=TRUE)
```

##

```{r}
fviz_pca_var(comp.p, col.var = "cos2", title = "Biplot - Componentes principais",
             gradient.cols = c("#002951", "#eeeeee","#a0000a"), repel = TRUE)
```

# Análise Fatorial

##

```{r}
af.reg <- factanal(data |> select_if(is.numeric),
                   factors = 2,
                   scores="regression", 
                   nstart = 10)
```

```{r}
auto <- autoplot(af.reg,
         data = data,
         colour = "Sex",
         label = FALSE,
         loadings = TRUE,
         loadings.colour = "#444444",
         loadings.label = TRUE,
         loadings.label.colour = "black",
         label.colour = "black",
         loadings.label.size = 5
) +
  theme_bw()
```

##

```{r echo=FALSE}
auto
```

# Considerações Finais
