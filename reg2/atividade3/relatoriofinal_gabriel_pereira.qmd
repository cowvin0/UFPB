---
format: 
    pdf:
      toc: true
      toc-depth: 3
      toc-title: Sumário
header-includes:
  - \usepackage{fancyhdr}
  - \usepackage{graphicx}
  - \usepackage{eso-pic}
  - \usepackage{tikz}
  - \AtBeginDocument{\thispagestyle{empty}\begin{tikzpicture}[remember picture,overlay]
          \node at (current page.south) [yshift=20cm] {\includegraphics[width=0.15\paperwidth,height=0.15\paperheight,keepaspectratio]{logo1.png}};
          \node at (current page.center) [yshift=4cm] [anchor=north,yshift=-2cm] {\Huge\textbf{Aplicação de modelos GAMs na}};
          \node at (current page.center) [yshift=3cm] [anchor=north,yshift=-2cm] {\Huge\textbf{modelagem da pontuação geral em ciências}};
          \node at (current page.center) [yshift=1.5cm] [anchor=north,yshift=-2cm] {\LARGE\textbf{Universidade Federal da Paraíba - UFPB}};
          \node at (current page.south) [yshift=5cm] [anchor=north,yshift=-2cm] {\large\textbf{Abril 2024}};
          \end{tikzpicture}\clearpage}
documentclass: scrreprt
lang: pt
urlcolor: SeaGreen
linkcolor: SeaGreen
author: Gabriel de Jesus Pereira - 20200121424
date: today
date-format: long
warning: false
echo: false
monofont: "Ubuntu Mono"
monofontoptions: Scale = 1
fig-cap-location: top
---

```{r} 
library(tidyverse)
library(tidymodels)
library(caret)
library(pROC)
```

```{r} 
data <- ISLR::Default
splits <- initial_split(data, prop = 0.80, strat = default)
train <- training(splits)
test <- testing(splits)
```

\newpage

# Introdução

Na jornada de uma criança, a educação desempenha um papel crucial, moldando a mente dos jovens e preparando indivíduos para enfrentar os desafios do mundo. Dentro deste vasto campo educacional, as ciências assumem um papel central e fundamental. Através da educação científica, as crianças não apenas adquirem conhecimento sobre os princípios básicos do universo, mas também desenvolvem habilidades críticas, como pensamento análitico, resolução de problemas. Além disso, ao integrar as ciências na educação das crianças, estamos preparando o terreno para um futuro sustentável e inovador.

Neste contexto, o presente trabalho tem como objetivo utilizar técnicas de Modelo Aditivo Generalizado, fazendo uso de um banco de dados sobre educação. Utilizando esse banco de dados, foi modelada a nota de disciplinas de ciências de crianças de 15 anos. As outras variáveis que estão no banco de dados é a **explicação**, a pontuação ao se explicar o fenômeno científico, **interesse** em ciência, **apoio** a pesquisa científica, **renda**, índice de **educação** e o **IDH**.

# Metodologia

As análises foram feitas utilizando a linguagem de programação R (R Core Team 2023) com o framework de modelagem estatística *tidymodels* (Kuhn e Wickham 2020). Além disso, os documentos do relatório e a apresentação foram feitos com o Quarto (Allaire et al. 2022), um sistema de escrita e publicação científica.

## Análise exploratória

Um dos primeiros passos para qualquer estudo estatístico, é fazer a análise exploratória dos dados. Dessa forma, esse foi o primeiro passo tomado nesse projeto, utilizando medidas de tendência central e de dispersão, como média, mediana, desvio-padrão e coeficiente de correlação, além da utilização de gráficos e tabelas com o objetivo de caracterizar e compreender melhor os eventos em questão. Além disso, foram elaborados gráficos para observar o comportamento da variável resposta e das variáveis preditoras.

## Construção do modelo


## Formas de avaliação do modelo


### Erro quadrático médio

### Coeficiente de determinação

# Resultados

## Exploração dos dados

```{r}
data |> 
  pivot_longer(
    c(balance, income),
    names_to = "variable",
    values_to = "values"
  ) |>
  ggplot(aes(x = values, fill = default)) +
  geom_density(alpha = 0.4) +
  facet_wrap(
    vars(variable), 
    scales = "free",
    labeller = as_labeller(
      c(`balance` = "Balança",
        `income` = "Renda")
      )
    ) +
  scale_fill_brewer(palette = "Set1", name = "Inadimplência", 
                    labels = c("Não", "Sim"), direction = -1) +
  labs(x = "", y = "") +
  theme_bw()
```

```{r}
data |> 
  ggplot(aes(balance, income, color = default)) +
  geom_point(alpha = .4, size = 3.3) +
  scale_color_brewer(palette = "Set1", labels = c("Não", "Sim"), 
                     direction = -1, name = "Inadimplência") +
  theme_bw() +
  labs(y = "Renda", x = "Saldo")
```
```{r}
data |> 
  ggplot(aes(x = forcats::fct_infreq(default))) +
  geom_bar(
        aes(
          y = after_stat(count) / sum(after_stat(count)), 
          fill = default
          ),
        show.legend = FALSE,
  ) +
  theme_bw() +
  theme(axis.title.x = element_blank()) +
  scale_fill_brewer(palette = "Set1") +
  labs(y = NULL, x = NULL) 
```
```{r}
data |> 
  ggplot(aes(x = forcats::fct_infreq(student))) +
  geom_bar(
        aes(
          y = after_stat(count) / sum(after_stat(count)), 
          fill = student
          ),
        show.legend = FALSE,
  ) +
  theme_bw() +
  theme(axis.title.x = element_blank()) +
  scale_fill_brewer(palette = "Set1") +
  labs(y = NULL, x = NULL) 
```


## Construção do modelo

```{r}
workflow <- workflow() |>
  add_model(logistic_reg(), formula = default ~ .) |>
  add_recipe(train |>
               recipe(default ~ .) |> 
               step_dummy(all_nominal_predictors())
               )

model <- workflow |>
  fit(train)

metricas <- model |> 
  extract_fit_engine() |> 
  summary()

probs_previstas <- predict(model, new_data = test, type = "class")
```

# Conclusões

# Anexos