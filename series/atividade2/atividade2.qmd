---
title: Análise do ICMS do Estado do Rio de Janeiro
author: Gabriel de Jesus Pereira
Date: 'today'
execute:
  refresh: true
  warning: false
  error: false
  eval: true
  echo: true
revealjs-plugins:
  - attribution 
  - roughnotation
  - pointer
format: 
  revealjs:
    theme: [default, style.scss]
    embed-resources: true
    transition: slide
    background-transition: fade
    scrollable: true
    preview-links: auto
editor:
  markdown:
    wrap: 72
lang: pt-br
---

```{r echo=FALSE, warning=FALSE}
library(modeltime)
library(deflateBR)
library(tseries)
library(rlang)
library(stats)
library(forecast)
library(seastests)
library(tidyverse)
library(timetk)
```

## Carregando a série temporal

```{r}
dados <- readxl::read_xls("ipeadata[15-03-2024-10-52].xls") |> 
  mutate(Data = paste0(Data, ".01") |> 
           as.Date(format = "%Y.%m.%d"),
         Mês = factor(month(Data, label = TRUE)),
         Ano = factor(year(Data))
         )
```

# A série temporal

Os dados são do ICMS do estado do Rio de Janeiro, coletados no período de janeiro de 1993 a dezembro de 2023.

## Deflação

```{r}
dados <- deflate(dados$ICMS, dados$Data, "12/2023", "igpm") |> 
  ts(start = c(1993, 1), frequency = 12) |> 
  (\(x) {
    tibble(
      Data = time(x) |>
        zoo::as.Date(),
      ICMS = c(as.matrix(x))
      ) |> 
      mutate(
        Ano = factor(year(Data)),
        Mês = factor(month(Data, label = TRUE))
      )
  })()
```

# Análise exploratória

## A Série temporal

::: {.panel-tabset}

### Código

```{r output=FALSE}
Temp <- dados |> 
  plot_time_series(
    Data, 
    ICMS,
    .interactive = TRUE,
    .title = ""
    )
```

### Série temporal

```{r echo=FALSE}
Temp
```

:::

## Análise dos meses

::: {.panel-tabset}

### Código

```{r output=FALSE}
Seas <- dados |> 
  ggplot(
    aes(
      x = Mês, 
      y = `ICMS`, 
      group = Ano,
      color = Ano
      )
    ) +
  geom_line() +
  theme_bw() +
  labs(y = "ICMS", x = "") +
  scale_color_manual(values = viridis::mako(33))
```

### Meses de cada ano

```{r echo=FALSE}
Seas
```
:::

# Sazonalidade e Estacionariedade

