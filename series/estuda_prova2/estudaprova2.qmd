---
title: estuda provinha
author: gabriel
---

```{r}
library(seastests)
library(forecast)

data(UKLungDeaths)
autoplot(ldeaths)
isSeasonal(ldeaths, test = "welch")
ggseasonplot(ldeaths)
```

```{r}
m.a <- HoltWinters(ldeaths, seasonal = "addit")
nivel <- m.a$fitted[1, 2]
tendencia <- m.a$fitted[1, 3]
sazonal <- m.a$fitted[1, 4]

y.hat.1 <- nivel + tendencia + sazonal
plot(m.a, xlab="Tempo", ylab="Valores observados/estimados")

z = ts(cbind(m.a$fitted[,2],m.a$fitted[,3], 
             m.a$fitted[,4]),start=c(1950,1),freq=12)

plot(z,main="",xlab="")

m.m=HoltWinters(ldeaths, seasonal="multiplicative")
m.m$fitted[1:15,]

nivel = m.m$fitted[1,2]
tendencia = m.m$fitted[1,3]
sazonal = m.m$fitted[1,4]
# Valor estimado pelo algoritmo HW-M
y.hat.1 = (nivel + tendencia) * sazonal

plot(m.m, xlab="Tempo", ylab="Valores observados/estimados")

z = ts(cbind(m.m$fitted[,2],m.m$fitted[,3],
m.m$fitted[,4]),start=c(1950,1),freq=12) 
plot(z,main="",xlab="")
```

