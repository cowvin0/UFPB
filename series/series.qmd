---
title: Séries temporais de venda de 
author: Gabriel de Jesus Pereira
date: '`r Sys.Date()`'
execute:
  refresh: true
  warning: false
  error: false
  eval: true
  echo: true
revealjs-plugins:
  - attribution 
  - roughnotation
  - pointer
format: 
  revealjs:
    theme: [default, style.scss]
    embed-resources: true
    transition: slide
    background-transition: fade
    scrollable: true
    preview-links: auto
editor:
  markdown:
    wrap: 72
lang: pt-b
---

```{r echo=FALSE}
library(modeltime)
library(tseries)
library(seastests)
library(tidyverse)
library(timetk)
```

# Sobre os dados de séries temporais

- São dados de vendas de lojas da Corporación Favorita, uma grande varejista de supermercados com sede no Equador.

- Uma das características da série é que o setor público é pago a cada duas semanas, no dia 15 e no último dia do mês, podendo aumentar as vendas de supermercado.


# Leitura e limpeza dos dados

```{r echo=TRUE}
data <- readr::read_csv(
  "train.csv"
  ) |> 
  group_by(date) |>
  filter(family == "AUTOMOTIVE")
  summarise(sales = mean(sales)) |>
  filter(year(date) == 2016) |>
  mutate(
    Semana = factor(week(date)),
    Dia = factor(day(date)),
    Mês = factor(month(date, label = TRUE)),
    Ano = factor(year(date)),
    Dias_Semana = factor(
      stringr::str_to_title(weekdays(date)),
      levels = c(
        "Segunda", "Terça",
        "Quarta", "Quinta",
        "Sexta", "Sábado",
        "Domingo"
        )
      )
  )

teste.adf <- data |> pull(sales) |> adf.test()
teste.kpss <- data |> pull(sales) |> kpss.test()
teste.pp <- data |> pull(sales) |> pp.test()
```

# Análise exploratória

# Análise por mês

::: {.panel-tabset}

### Código

```{r output=FALSE}
Temp <- data |> 
  plot_time_series(
    date, 
    sales,
    .interactive = TRUE
    )
```

### Série temporal

```{r echo=FALSE}
Temp
```

:::

## Análise por semana

```{r echo=TRUE}
data |> 
  ggplot(
    aes(
      x = Dias_Semana, 
      y = sales, 
      group = Semana,
      color = Semana
      )
    ) +
  geom_line() +
  theme_bw() +
  labs(y = "Venda", x = "") +
  scale_color_manual(values = viridis::mako(33))
```


##

```{r echo=TRUE}
data |> 
  plot_acf_diagnostics(
    date,
    sales,
    .interactive = TRUE
  )
```

